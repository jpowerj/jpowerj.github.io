---
import type { ImageMetadata } from 'astro'
import { Image } from 'astro:assets'

import { cn } from 'astro-pure/utils'

interface Props {
  class?: string
  name?: string
  courses: {
    courseid: string
    name: string
    description: string
    href?: string
    className?: string
  }[]
}
const { class: className, courses, ...props } = Astro.props
const images = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/projects/*.{jpeg,jpg,png,gif}'
)
---
<div class={cn(
    'grid gap-3',
    className,
  )}>
    {
      courses.map((course) => {
        var defaultImagePath = '/src/assets/projects/course-default.jpg'
        var imagePath = '/src/assets/projects/' + course.courseid + '.jpg'
        if (!images[imagePath]) {
          imagePath = defaultImagePath
        }
        if (!images[imagePath]) {
          throw new Error(`${imagePath} not found via glob`)
        }

        return (
          <a
            class={cn(
              course.className,
              'group overflow-hidden no-underline relative flex flex-col flex-grow rounded-2xl border bg-muted',
              course.href && 'transition-all hover:border-foreground/25 hover:shadow-sm '
            )}
            href={course.href || "https://github.com/jpowerj"}
            target='_blank'
          >
            <Image
              src={images[imagePath]()}
              alt={course.name}
              class='absolute top-0 h-60 w-full object-cover opacity-30 transition-opacity group-hover:opacity-55 group-hover:blur-[0.5px] dark:opacity-35'
              loading='lazy'
            />
            <div
              class='z-10 flex flex-col flex-grow items-start justify-between gap-y-0.5 px-5 pb-4 pt-2'
            >
              <p class='text-lg text-foreground bold text-foreground mt-1 mb-1 group-hover:text-shadow-white-2xl/90'>{course.name}</p>
              <p class='text-muted-foreground self-start mt-1 mb-1'>{course.description}</p>
            </div>
          </a>
        )
      })
    }
  </div>
